Pitfalls of Bitcoin’s Proof-of-Work: R&D Arms Race and Mining CentralizationHumoud Alsabah and Agostino Capponi?†AbstractDoes Bitcoin’s proof-of-work (PoW) protocol serve its intended purpose of enabling and supporting a decentralized payment system? To address this question, we develop a game theoretical model where firms invest in research and development (R&D) before competing in a Bitcoin mining game. We show that firms fail to capture the surplus created from their research, because higher research expenditures induce a more aggressive mining game. Promoting R&D spillovers not only reduces wasteful R&D duplication and increases firms’ profits, but may also raise the security of the Bitcoin system. We calibrate our model to rewards and operational costs of the Bitcoin system, and quantitatively demonstrate that the mining industry has a tendency towards centralization, against the core principles of cryptocurrencies.Keywords: Bitcoin, proof-of-work, mining, arms race, centralizationJEL Classification: C70, G2, D43, L13?Alsabah: Department of Industrial Engineering and Operations Research, Columbia University, 500 W 120th St, New York, NY 10027; hwa2106@columbia.edu. Capponi: Department of Industrial Engineering and Operations Research, Columbia University, 500 W 120th St, Mudd 535-G, New York, NY 10027; ac3827@columbia.edu. An earlier version of this paper was titled “Bitcoin Mining Arms Race: R&D with Spillovers.” We are grateful to Aurelien Baillon, Yannis Bakos, Matthieu Bouvard (discussant), Guillaume Haerringer, Hanna Halaburda, Gur Huberman, Steven Kou, and Emiliano Pagnotta for constructive comments. We are grateful to , Konstantin Sokolov, and Harald Uhlig for constructive comments, and to participants of the INFORMS Annual Meeting (2018, 2019), the Second Toronto FinTech Conference, the inaugural Tokenomics International Conference, (International Conference on Blockchain Economics, Security and Protocols), the 2019 Annual Meeting of the Central Bank Research Association, the Fintech and Machine Learning Workshop at National University of Singapore (2019), and the Bank of Canada for valuable feedback. A thoroughly revised version of this manuscript has been posted at https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3869144 under the title “Proof of Work Cryptocurrencies: Does Mining Technology Undermine Decentralization?”, and co-authored, in the order, by Agostino Capponi, Sveinn Olafsson, and Humoud Alsabah. This new version model mining and manufacturing as distinct economic activities, and replace the stage where miners engage in R&D with a stage where miners can invest in new mining hardware, developed by an exogenous manufacturing sector.†Department of Industrial Engineering and Operations Research, Columbia University, New York, NY, 10027. Emails: hwa2106@columbia.edu (Alsabah) and ac3827@columbia.edu (Capponi).	1	IntroductionSince its deployment in January 2009, Bitcoin has experienced rapid growth. As of January 23, 2020, there are about 18 million bitcoins in circulation with a bitcoin-to-USD exchange rate of $8,368.Bitcoin’s market capitalization therefore exceeds $152 billion, making it the most successful of more than 1,500 cryptocurrencies used today.At the heart of Bitcoin is the blockchain, a decentralized digital ledger in which transactions are recorded publicly. As no central authority supervises the integrity of the transactions, the Bitcoin system relies on a network of computers (also referred to as nodes or users) to verify, update and store transactions. This decentralized mechanism requires the participation of a sufficient number of nodes that are willing to incur the costs associated with updating the ledger. The Bitcoin system also requires that these users achieve a consensus about the correct record of transactions. The incentive for nodes to undergo these tasks arises from a process called mining. Miners (i.e., nodes or transaction validators) compete to solve a computationally costly problem known as proof-of-work (PoW). The winner of the mining process has the right to update the record. He is rewarded with newly minted coins and keeps the transaction fees.The apparent vision of Nakamoto (2008), the creator of the Bitcoin system, is a decentralized payment system in which mining can be performed by practically anybody using off-the-shelf computers. However, with the rise of the bitcoin price ($/BTC), firms started to invest in the development of efficient hardware to increase their computational power, and thus their probability of successfully mining blocks. With such an increase in the deployment of computational power, mining became unprofitable for individual miners using home computers. It then migrated to data centers where operating costs, including land, construction, electricity and taxation, are low.Furthermore, mining operations have become increasingly vertically integrated, with single firms designing mining chips, maintaining the hardware and operating one or more data centers. For example, Cheng (2018) reports that Bitmain, the largest mining hardware manufacturer, is opening mining farms in Canada and Switzerland, in addition to the data centers it already operates in China. In its IPO Prospectus, Bitmain (2018) reports that its revenues from proprietary mining for the years 2015, 2016, and 2017, have been, respectively, $27,944,000, $53,586,000, and $199,330,000, averaging a yearly 300% increase from self-mining. Khatri (2019) states that Bitfury, another major mining hardware producer, is “launching a network of Bitcoin mining operations in Paraguay,” in addition to those that are already active in Canada, Norway, Iceland and the Republic of Georgia. According to Taylor (2017), an important reason for merging these operations is to improve efficiency, because mining equipment and data centers can be co-designed. Additionally, merged operations shorten the time required to get the mining equipment running because the equipment does not need to be packaged, troubleshooted, tuned, and shipped to customers.These major developments in mining technology bring up the following questions: does Bitcoin’s PoW protocol still serve its intended purpose of supporting a decentralized payment system? Would firms attain higher profits from more efficient mining equipment? Answering these questions is critical to assess Bitcoin’s ability to maintain its dominant position among cryptocurrencies, especially given the fact that Bitcoin was envisioned as a completely decentralized system where miners’ profitability is essential for its continued operation.We formalize miners competition via a two-stage game. Firms invest in R&D in the first stage, and decide on the computational power to exert in the second stage mining game. The payoff of a firm consists of the second-stage mining profits net of the first-stage R&D expenditure. Investing in R&D results in more efficient mining equipment, and thus allows firms to mine bitcoins at a smaller cost. Our model is designed to capture two key properties of the PoW protocol: (i) the total reward from mining is independent of the miners’ total computational power, and (ii) the share of rewards attained by a miner is proportional to the fraction of his computational power (relative to the aggregate). The first property is a consequence of the adaptive difficulty level of the computational problem that ensures a steady rate of newly minted bitcoins. The second property is intrinsic to the Bitcoin’s hashing function, where a higher computational power implies a higher probability of successful mining.In the mining game, firms simultaneously decide on the usage of computational power, henceforth also referred to as hash rate or hashing power, to maximize the profits resulting from their mining activity. We show that the per-unit hash cost threshold above which a firm becomes inactive is slightly above the average per-unit hash cost of active miners. This result highlights the risk of mining centralization, as firms that do not sufficiently invest in R&D to develop cost effective mining hardware would eventually be forced out of the market, no matter how high the rewards from the Bitcoin system are. Bitcoin mining hardware developers that went out of business due to their inability to keep up with the rapid development of efficient hashing technology include TerraHash, KnCMiner, HashFast, and CoinTerra; see Taylor (2017).In the first stage of the game, firms choose R&D levels to maximize their overall expected profits, accounting for the equilibrium hash rate profile implied by their choices. We show that the aggressive competition in the mining game prevents firms from capturing the surplus created by their research, i.e., a R&D arms race ensues. This stands in contrast with predictions of Cournot models typically used in the industrial organization literature (see, for example, d’Aspremont and Jacquemin (1988), Kamien et al. (1992), Suzumura (1992)), where investing in research improves firms’ aggregate profits even though firms subsequently compete over sales. The fundamental difference is that, in the mining game designed by Nakamoto (2008), the aggregate reward attainable from mining is non-expansive, i.e., increasing the system’s aggregate hash rate does not increase Bitcoin mining rewards. Hence, regardless of the total research investments, the aggregate rewards that can be extracted from the Bitcoin system are the same. We show that investing in R&D improves firms’ profits only if firms agree to curb their hashing power by coordinating decisions made in the second stage mining game.We develop an extension of the framework that accounts for R&D spillovers, i.e., benefits from the research conducted by a firm partly accrue to other firms at zero cost. We demonstrate that spillovers have two countervailing effects on the equilibrium amount of aggregate hash cost reduction. While technology spillovers are beneficial to all firms, they also create free-riding incentives: generated knowledge spills over from the inventor to rival firms, thus weakening firms’ incentives to invest in R&D. We show that the positive knowledge spillovers prevail over the negative free-riding effects as long as spillovers are not too high. As a result, the presence of spillovers not only reduces wasteful R&D duplication and increases firms’ profits, but also raises the system’s aggregate hash rate, hence augmenting the security of the Bitcoin system. Our results thus argue in favor of policies that promote spillovers from mining hardware technology through regulations governing patents and transfer of employees between firms.We calibrate our model to data from Bitmain’s IPO prospectus (Bitmain (2018)). We base our estimates of firms’ mining hardware efficiency on Antminer S9 SE, the most popular mining hardware in the market. We use Bitmain’s historical R&D expenditures during the period January 2015-June 2018, and account for improvements in the mining hardware resulting from these investments, to estimate R&D costs in our model. To measure rewards, we follow the current Bitcoin protocol in which miners receive 12.5 bitcoins and get to keep transaction fees as block rewards approximately every 10 minutes. We first confirm empirically that the calibrated model accurately predicts the evolution of hash rate over time. We then use the calibrated model to show that the Bitcoin’s mining industry has a tendency towards centralization due to the Matthew effect: firms with an initial advantage in mining hardware efficiency have an incentive to invest more in R&D, and thus further increase their advantage over rival firms with less efficient hardware. We measure the level of mining concentration using the Herfindahl index, and analyze the extent to which centralization increases with mining rewards. If the average bitcoin price were to stay at $20,000 (such a price was momentarily exceeded in December 17, 2017), then the Herfindahl index would increase by 19.4% in just 9 months.The remainder of the paper is organized as follows: Section 2 positions our paper relative to existing literature. Section 3 presents the model. Section 4 characterizes the equilibrium of the mining game, and studies its properties. Section 5 characterizes the equilibrium R&D investment and analyzes the impact of spillovers on the equilibrium hash rate and R&D. Section 6 calibrates the model and quantifies the implied degree of mining centralization. Section 7 concludes. Technical proofs are deferred to the appendix.	2	Literature ReviewNakamoto (2008) was the first to outline the conceptual and technical details of the Bitcoin payment system. In January 2009, Nakamoto released the first Bitcoin software that launched the network. Since its deployment in 2009, Bitcoin has attracted significant attention from academics, practitioners and policy makers. We refer the reader to B¨ohme et al. (2015), Halaburda and Sarvary (2016), and Narayanan et al. (2016) for an overview of Bitcoin and its operations. Few studies have focused on bitcoin valuation and pricing (Pagnotta and Buraschi (2018), Pagnotta (2018), and Biais et al. (2018)), while others have considered the optimal design of cryptocurrencies and sustainable alternatives (Chiu and Koeppl (2017), Saleh (2018a,b), Hinzen et al. (2019)). Our work takes the mechanism as given and focuses on the operational side of the Bitcoin’s PoW protocol, analyzing miners’ economic incentives and strategic behavior.In recent years, there has been an increased interest in the analysis of Bitcoin operations. Huberman et al. (2019) investigate how miners are paid in the long run through a model where transaction fees are determined as the steady state of a congestion queueing game. They show that congestion is critical for the survival of the Bitcoin system, and propose modifications to the design of the current protocol to steer congestion towards the desired level. A related study by Easley et al. (2019) employs a game-theoretic framework to study the interactions between miners and users, and the factors leading to the emergence of transaction fees. Biais et al. (2019) show that, while mining the longest chain is an equilibrium, the blockchain protocol is a coordination game and hence admits multiple equilibria. In their model, forks depend on the number of miners who choose a specific branch. A different model specification by Abadi and Brunnermeier (2018) consider forks that depend on users’ preferences, rather than those of miners, and analyze the tradeoffs between centralized and decentralized record-keeping tools. Unlike these papers, we endogenize miners’ hash rate and R&D decisions and analyze the efficiency of the equilibrium outcome.Our paper is also related to Dimitri (2017), which models Bitcoin mining as a simultaneous game, where each miner decides on the amount of hash rate to exert. He characterizes the equilibrium hash rate profile, and shows that the special structure of the Bitcoin system prevents the formation of a monopoly. In a similar framework, Biais et al. (2019) show that the system hash rate prevailing in equilibrium is higher than the level that would maximize firms’ aggregate profits. We extend the framework of Dimitri (2017) by allowing firms to invest in R&D to develop more efficient mining hardware before competing in the mining game. Different from the above mentioned studies, which only focus on the equilibrium hash rate profile, we additionally characterize the R&D investment profile. The study by Arnosti and Weinberg (2019), contemporaneous to our work, adopts the framework of Dimitri (2017) and show that small differences in firms’ hash costs can increase concentration in the mining industry. Different from their model, firms’ hash costs are endogenous in our framework. Using a calibrated model, we demonstrate that R&D contributes to driving the Bitcoin mining industry towards centralization, and that the extent of this phenomenon strongly depends on Bitcoin rewards.Our paper also contributes to the literature on R&D with spillovers. In their study, d’Aspremont and Jacquemin (1988) analyze the extent of technological advance attained when two firms invest in R&D, before competing in sales. They show that, when the demand function is linear in price, cooperative R&D leads to a greater advance in technology than competitive R&D if spillover effects are substantial. Their model has been generalized in several follow-up studies, including Kamien et al. (1992) and Suzumura (1992) who verify the robustness of the results in an oligopolistic setup and under a more general class of demand functions. The competitive nature of the Bitcoin mining game leads to profound differences with respect to those studies: cooperative R&D leads to a lower technological advancement than competitive R&D, that is, firms exert a lower level of R&D when they cooperate, regardless of the magnitude of spillovers.	3	ModelWe consider an industry consisting of N ≥ 2 firms, which engage in a two-stage competition. In the first stage, each firm i commits to a level xi of R&D. In the second stage, each firm i chooses the hash rate hi used for mining. We assume that firms follow the longest-chain rule described by Nakamoto (2008) when appending blocks. Each firm i incurs a cost Ci(hi,xi) for mining, which depends on its own hash rate, hi, and on the amount of research xi it undertakes. The cost function Ci(hi,xi) is assumed to be linear in both variables separately, and is given byCi(hi,xi) = (? ? xi)hi,where xi ≤ ? < ?. The parameter ? represents the firm’s initial marginal hash cost (i.e., prior to any R&D investment). Investments in R&D allow firms to develop more energy efficient mining equipment and hence reduce the marginal hash cost. The quantity ? is the maximal amount by which marginal costs can be reduced after investing in R&D. The inequality ? < ? ensures that the marginal costs from mining are not reduced to zero. This assumption reflects the fact that firms always need to pay a cost for electricity, regardless of how much they improve the efficiency of hash rate energy consumption. We assume a quadratic R&D cost function, i.e., if firm i invests xi units in R&D, then it incurs a cost ?x2i /2, where ? is a positive constant. The specification of this cost function captures the diminishing returns to scale property of R&D; see Dasgupta (1986), Acs and Audretsch (1988), and Roper (1997) for supporting empirical evidence.Rewards (i.e., newly minted bitcoins and transaction fees) are allocated among the firms depending on the distribution of hash rates h = (h1,...,hN). Firm i’s share of the reward is given by,where and R is the total block and transaction fee reward obtained in the second period (see Appendix A for a discussion of the functional form of the reward function). This function captures the two most critical properties of Bitcoin’s PoW protocol. First, the reward obtained by miners is proportional to the fraction of hashing power they own. Second, the amount of coins that can be mined in a given period is fixed regardless of the total hashing power exerted. The first property reflects the brute force nature of the hash function used in the PoW protocol, where exerting more hashes per second implies a higher probability of successfully mining a block. The second property reflects the changing difficulty level of the computation problem in Bitcoin, which ensures that the number of mined blocks in a fixed time interval is, on average, the same regardless of the total hashing power exerted by firms.The objective of each firm is to maximize its individual second-stage mining profits net of its first-stage R&D expenditure. We solve for the subgame perfect equilibrium of this two-stage game using backward induction. We first solve the second-stage game for a given R&D profile x = (x1,x2,...,xN). We then analyze the first-stage game and characterize the equilibrium firms’ R&D levels.	4	Mining GameIn this section, we characterize the equilibrium hash rate profile and show its uniqueness. Our analysis is related to that of Dimitri (2017) and Biais et al. (2019), which characterize the equilibrium hash profile in the special case where the marginal hash cost, ci, satisfies the condition for any firm i. Unlike these studies, we characterize the equilibrium hash profile for any marginal hash costs profile (i.e., any R&D profile x). This is crucial in our framework because the marginal hash costs are endogenously determined by R&D decisions in the first stage game, and hence there is no guarantee that firms’ marginal hash costs satisfy the above mentioned condition.Without loss of generality, we assume that the R&D profile x = (x1,...,xN) satisfies	x1 ≥ x2 ≥ ··· ≥ xN.	(1)We denote bythe per-unit hash cost of firm i. It follows immediately that the ordering of x given by (1) induces the ordering c1(x1) ≤ c2(x2) ≤ ··· ≤ cN(xN) on the unit costs. Conditional on the R&D level xi, the profit from mining by firm i, if it exerts hash rate hi and its rivals choose the hash rate profile h?i, is given by	,	if H > 0,		otherwise.Definition 1. An equilibrium hash rate profile is a vector h suchthat, for all i,.Firm i is said to be active in equilibrium if	0.	The following proposition shows that, for any R&D profile x, there exists a unique equilibrium hash rate profile h?.Proposition 4.1. For any R&D profile x, there is a unique equilibrium hash profile h(x) := in which n firms are active. The equilibrium hash rate is given by	?	(	(x))	,	for 1 ≤ i ≤ n?hi (x) =(2)		for n + 1 ≤ i ≤ N456789Total Hash Rate (TH/s)107400060008000100001200014000Bitcoin Price (USD/BTC)Actual Hash Rate (TH/s)Bitcoin Price (USD/BTC)456789Total Hash Rate (TH/s)107400060008000100001200014000Bitcoin Price (USD/BTC)Actual Hash Rate (TH/s)Bitcoin Price (USD/BTC)	3	2000	01-Oct-2018	01-Jan-2019	01-Apr-2019	01-Jul-2019Figure 1: The solid black curve plots the historical aggregate hash rate (left axis), and the dashed red curve plots the bitcoin exchange prices (right axis) during the period August 2018-September 2019. The chart suggests a positive relation between the bitcoin price and the aggregate hash rate. (Data obtained from: https://www.blockchain.com/)where.The equilibrium number of active firms n is not known a priori, and depends on the R&D profile x. In Appendix B, we provide a convergent algorithm that can be used to find the equilibrium number of active firms n, and thus the unique equilibrium hash profile h(x). Summing the equilibrium hash rates over all firms, we obtain.Thus, the aggregate equilibrium hash rate H? depends on the costs of active firms only through their sum c(n). Moreover, consistent with intuition, for a fixed number n of active firms, the total hash rate H? is decreasing in the sum of their costs c(n). This implies that the total hash rate exerted in the system is non-decreasing in R&D investments x, that is, R&D competition between firms promotes a higher deployment of hash rate in the Bitcoin system.The equilibrium aggregate hash rate H? is proportional to the total reward R. Hence, our model predicts that aggregate hash rate is proportional to bitcoin price: an increase in price incentivizes firms to exert more hash rate, making the mining competition more fierce. Such a prediction is empirically supported, as it is clearly seen from Figure 1: the aggregate hash rate closely tracks the bitcoin price time series.The functional form of (2) reveals that firm i is active if and only if its per-unit hash cost satisfies. This inequality highlights the vulnerability of Bitcoin mining to centralization.For example, if n = 10, any firm whose per-unit hash cost is larger than the average by 11.1% will not be able to compete. If n = 20, a per-unit hash cost that exceeds the average by 5.3% is sufficient to drive the firm out of business. These observations follow directly from Proposition 4.1, and are formalized in the next corollary.Corollary 4.2. Let n be the number of active firms. A firm will not actively compete in mining if and only if its per-unit hash rate cost is larger than the average per-unit cost of active firms by atleast .Corollary 4.2 highlights the importance of investing in R&D to stay competitive in mining. It also provides an explanation for why firms race to develop more efficient mining machinery, as not doing so would force them out of the competition, regardless how high the rewards from mining are. These predictions are consistent with the statements released by Tai, the chairman of Hut 8Mining Corporation, to Bloomberg in an interview. “Smaller miners will drop out, and only five to 10 of the largest will survive and be profitable.” Unlike smaller miners, which buy hardware from other manufacturers, major mining companies such as Bitmain and Bitfury design and make their own chips and machines. Because of the large orders, they can also obtain discounts from their suppliers on the price of raw material purchased, and even get electricity at a lower cost. Quoting a statement of Tai: “We can buy and source orders of magnitude more.” “We can buy silicon in large quantities and commit to the electricity grid in chunk sizes. We have the cash to make the deposits and set them up.” In fact, Tai mentions that his company is currently undergoing discussions to connect to a nuclear power plant that is going online in about one year (we refer to Kharif (2018) for the full details).	5	R&D Arms RaceIn this section, we analyze the subgame perfect equilibrium (SPE) of the two-stage game, where firms strategically invest in R&D before competing in the Bitcoin mining game. We show that firms fail to capture the surplus created by their research because more investments in R&D leads to a more aggressive second stage mining game. We also extend the framework to allow for R&D spillovers, and show that they can increase firms’ profits and improve the security of the Bitcoin system.	5.1	Equilibrium R&D ProfileIn the first stage of the game, firms choose R&D levels x = (x1,...,xN) to maximize their profits. We restrict attention to symmetric subgame perfect equilibria, i.e., those for which xi = xNC (NC stands for no coordination) for i = 1,2,...,N. We use the superscript “NC” to distinguish this equilibrium outcome from cooperative outcomes that we study later in this section. We use xNC to denote a vector with identical entries equal to xNC. We make the following assumptions:Assumption 1.	•	.	•	? ≥ ?/2.Assumption 1.1 is common in studies that analyze R&D investments aimed at reducing production cost (e.g. d’Aspremont and Jacquemin (1988), Kamien et al. (1992), Goyal and MoragaGonz´alez (2001)), and guarantees that a firm’s profit function is concave in its R&D level. Assumption 1.2 is merely imposed so that equilibria can be characterized in terms of first-order conditions and are interior, that is, to guarantee that 0 < xNC < ?.Theorem 5.1. There exists a unique symmetric SPE. The equilibrium satisfies the following prop-erties:	•	An increase in the mining reward R increases the equilibrium R&D level and hash rate of anyfirm.	•	All firms invest a positive amount in R&D.The first part of the theorem is intuitive and consistent with empirical evidence: increasing rewards induces a stronger competition. Starting from January 1, 2017 through January 22, 2020, the bitcoin price surged from $997.69 to $8,722. In response to this increase, miners’ total hash rate increased from a level of 2.5 ? 106 TH/s up until 115 ? 106 TH/s. Moreover, the surge in price triggered a rapid development in mining hardware. According to the Bitcoin’s protocol, rewards resulting from newly issued bitcoins halves after every 210,000 verified blocks. Ceteris paribus, our theorem predicts that the next halving in mining rewards would cause firms to reduce their hash rate and research investments. The second part of the theorem asserts that all firms invest a positive amount in R&D. To assess the efficiency of this equilibrium outcome, we consider two benchmarks for comparison: (i) firms coordinate their decisions in R&D only, and (ii) firms coordinate both their R&D and hash rate decisions.We first consider firms’ choices when they coordinate R&D decisions in the first stage, but do not coordinate hash rate decisions in the second stage. The corresponding optimization problem is then given bymax?(x) xwhere ?(x), and πj(x) is firm j’s profit when the R&D profile in the first stage is x and firms exert the equilibrium hash profile h(x) in the second stage game. Restricting attention to symmetric R&D profiles, i.e., such that xi = xPC (PC stands for partial coordination) for i = 1,2,...,N, we obtain a unique solution given by.Surprisingly, even though investments in R&D reduce marginal costs of hashing, it is optimal for firms to set their R&D levels to zero. To understand why firms agree to not invest in R&D, observe the relationship between the first-order conditions when firms choose their R&D investments selfishly, i.e., = 0, and the corresponding conditions when they maximize the combined profits,i.e.,	= 0. Note that	,	(3)where the sum is the combined-profits externality conferred by firm i’s R&D expenditure on the profits of all other firms. Firms do not internalize this externality when they choose theirmining industry, the emphasis shifted towards graphics processing units (GPU). Due to their architecture, graphic adapters run cryptographic calculations much faster than CPUs. To improve power consumption, GPU was replaced by field-programmable gate array (FPGA) miners in June 2011. Such miners provided a nearly five-fold advantage in terms of power consumption as compared to GPU miners. All those devices became economically futile for Bitcoin mining after the emergence of application-specific integrated circuit (ASIC) miners in June 2012. ASIC miners’ only purpose is to run cryptographic calculations for mining. Their power efficiency is ten times higher than that of FPGA miners.R&D expenditures to maximize their own profits only, but they do so when they coordinate their R&D expenditures to maximize the aggregate profit. The size of the externality is,which is always negative. Moreover, the net effect of firm i’s R&D on the aggregate profit is,and hence the size of the negative externality is greater in absolute value than firm i’s gains from its research expenditure.Next, we analyze the situation where firms coordinate their decisions in both stages of the game. The corresponding optimization problem is then given bymax?(h;x)	(4) x,hwhere ?(h;x(h;x). If firms coordinate their hash rate decisions in the mining game, then it is optimal for each of them to set the hash rate 0 to the minimum amount requiredto mine successfully. For this choice of hash rate, it is straightforward to verify that, for each firm i,the R&D level	0 maximizes (4). Since?(h;x) =for small enough , firms are able to capture all the reward from Bitcoin mining, while incurring negligible mining costs. However, the exertion of a very low hash rate when firms fully coordinate their choices would essentially remove any barrier to entry in the mining game; miners with very high electricity costs and inefficient hardware would be able to actively compete and make profits.To account for this behavior, we make the following assumption.Assumption 2. There exists an infinite number of small miners with a marginal cost.Assumption 2 guarantees that the cost of mining for these small miners is large enough that they are not able to compete when mining firms do not coordinate their choices on h, but are able to do so when coordination leads to a low level of aggregate hash rate H. The counterparty of these small miners in the real world is households. Those are typically not endowed with sophisticated equipment, but would still join the competition if it is favorable to do so. In this set-up, it is most profitable for the fully coordinating firms to exert the minimum amount of hash rate H needed to keep the small miners out. That is, firms would choose H = HFC (FC stands for full coordination) so that,where is the profit function of an external competitor who sets his hashrate to he when the colluding firms set their hash rate to H. Therefore, it is always optimal to set		(5)in the second stage. In the first stage, when xi = xFC for i = 1,2,...,N, the profit maximizing R&D level is given by.Observe thatand hence, consistent with intuition, the total hash rate in the fully cooperative outcome is smaller than the corresponding quantity when firms never coordinate or only coordinate their R&D decisions in the first stage. Moreover, firms exert higher R&D when they fully coordinate than when they coordinate only on R&D. If firms coordinate all their decisions, less competition in the mining stage allows them to capture a higher share of the surplus created by their research, hence incentivizing more R&D expenditures. In other words, it is precisely the aggressive competition in the mining game induced by the Bitcoin’s PoW protocol that prevents firms from capturing the surplus created by their research. The following proposition formalizes the previous discussion.Proposition 5.2. The equilibrium aggregate hash rate and individual R&D levels satisfy the following inequalities:	•	HNC > HPC ≥ HFC.	•	xNC > xFC > xPC.Proposition 5.2 states that, in equilibrium, firms invest excessively in R&D relative to the R&D level that maximizes the aggregate firms’ profits. If firms were to coordinate their R&D decisions and choose xPC = 0, then any firm i would have an incentive to increase its research level xi to improve its profits, leading to a R&D arms race.	5.2	R&D Spillovers and Equilibrium OutcomeWe examine the effect of R&D spillovers on the equilibrium outcome. Firms typically have difficulties protecting their intellectual property. Channels for technology to spread include the movement of personnel between firms, informal communication networks between engineers, and information leakage from input suppliers. We extend the cost function to account for spillovers as follows:,where 0 ≤ ? ≤ 1 and xi + ? Pj6=i xj ≤ ? < ?. The spillover parameter ? captures the extent to which the investment in R&D of other firms j 6= i lowers firm i’s unit hash cost. That is, successful inventions of rivals can be imitated by firm i at a lower cost than if firm i were to produce theinvention itself.Assumption 10.1..2.Assumption 10 is the generalization of Assumption 1 when we account for spillovers. The following proposition characterizes the sensitivity of equilibrium hash rate and R&D levels to spillovers.Proposition 5.3. There exists a unique symmetric SPE. The equilibrium satisfies the followingproperties:	•	An increase in the amount of spillover ? decreases the R&D level and increases the profit of any firm.	•	The total hash rate  is increasing in ? when anddecreasing in ? otherwise.The first part of Proposition 5.3 highlights the firms’ free-riding incentives: when a firm decides its R&D level, it takes into account the knowledge spillovers captured from other firms. Hence, large spillovers dilute the incentives to engage in R&D, which in turn reduces the R&D arms race and hence improves firms’ profits. In the limiting case ? ? 1 where the research benefits of a firm accrue in full to others, i.e., firms form a research joint venture, the R&D level approaches zero.Surprisingly, even though the absence of spillovers incentivizes firms to invest the maximum in R&D, this does not necessarily result in the maximal level of hash rate HNC deployed in the system. In fact, unless competition in the mining industry is a duopoly, the total hash rate is maximized if the spillover parameter takes an interior value. This is because the aggregate hash rate is proportional to the effective R&D XNC := xNC(1+?(N ?1)), which represents the level of R&D that each firm would have to apply to obtain a marginal hash cost reduction of XNC in the absence of spillovers. Spillovers have a nonlinear impact on the effective R&D. On the one hand, a higher spillover parameter reduces firms’ costs because of the positive knowledge spillovers gained from rivals. On the other hand, a higher spillover parameter weaken firms’ incentives to invest in R&D because of the free-riding behavior. The positive R&D externality dominates the negative free-riding effect as long as spillovers are not too high.The total hash rate H exerted by firms protects Bitcoin users against attacks from malicious participants outside of the Bitcoin system (the so-called Goldfinger attack). These external attacks are typically launched by competing platforms, wishing to promote an alternative cryptocurrency. According to Bonneau et al. (2015), competing cryptocurrencies with low mining capacity have already been attacked by Bitcoin miners using the so-called 51% attack. The attackers were able to amass enough computing power to control these small networks and compromise the integrity of transactions, which resulted in users losing trust in these small networks. Clearly, as the Bitcoin’s aggregate hash rate increases, it becomes considerably more costly and difficult for external attackers to succeed. Thus, Proposition 5.3 shows that the presence of spillovers, not only increases firms’ profits, but also raises the security of the Bitcoin system.Technology spillovers between firms in the Bitcoin mining industry are currently very low (? ≈ 0). Firms tend to protect their inventions through patents and strive to keep any unprotected information secret. In its IPO Prospectus, Bitmain (2018) states: “Our trademarks, copyrights, patents, domain names, knowledge, proprietary technologies and similar intellectual properties are critical to our success, and we rely on intellectual property laws and contractual arrangements, including confidentiality clauses, invention assignment and non-compete agreements with our employees and others, to protect our proprietary rights.” Hence, our results highlight the need of taking a stand against non-compete agreements, and to make patents harder to obtain in the mining technological sector. Because patents play a critical role in promoting innovation for most other areas of technology (e.g. personal computers, mobile devices, wearable technology), it would be necessary to implement legislative changes in intellectual property laws, considering that patents are currently not awarded in a discretionary fashion depending on the sector.	6	CalibrationIn this section, we calibrate our model to Bitcoin’s current rewards and operational costs, and use the calibrated model to predict the aggregate hash rate. Unlike the homogeneous setting considered in Section 5, we allow for some firms to have an initial cost advantage over others (e.g. lower electricity costs). As a result, firms make different R&D and hash rate decisions relative to each other. Using our calibrated model, we show that the results from Section 5 are robust against heterogeneity in firm-specific initial marginal hash costs ?i. We also show that firms with a lower initial marginal hash cost will invest more in R&D relative to those with higher costs, and thus increase their competitive advantage even more.	6.1	Identification of Model PrimitivesMining facilities tend to secretive about their operations. Little is known about the number of competing firms and the amount of energy consumed by computing equipment. We base our estimates of firms’ power usage effectiveness on the energy efficiency of Antminer S9 SE, the most recent mining hardware of Bitmain’s Antminer S series line. This is the most popular line of mining hardware in the market, and accounts for a 60% share of the hash rate in the Bitcoin network (Bitmain (2018)). Antminer S9 SE produces a hash rate of ¯r = 16 terahash per second (TH/s) and consumes ¯w = 1.28 kilowatts, resulting in a power consumption of 80 joules per terahash (J/TH). Since Bitmain released the first version of its S9 mining hardware line in June 2016, the average time between consecutive releases of new mining hardware in this line has been 9 months. We thus set the duration of the mining game to D = 9 months.We split the initial marginal hash cost of a firm into two components: (i) hashing electricity costs, and (ii) equipment costs. Most of large scale Bitcoin mining farms are located in cheap areas, such as Irkutsk where electricity costs are about $0.045 per kilowatt hour (kWh), and Reykjavik where these costs are about $0.055 per kWh. We set the electricity cost of an average firm to e¯ = $0.05 per kWh, and use the power efficiency of Antminer S9 SE to compute the marginal hashing electricity cost 24hour?30day?D = $25.92 per TH/s, where  is the per-hour cost of exerting a unit of TH/s. We use Antminer S9 SE to estimate the equipment cost. As of 21 of November 2019, the price of Antminer S9 SE is $430 per unit. Bitmain (2018) reports its gross profit margin during the first six months of 2018 to be 36.2%. We thus estimate the cost of equipment as $430(1 ? 0.362) = $274.34 per unit. Since each unit of Antminer S9 SE produces r¯ = 16 TH/s, we estimate a marginal equipment cost of ?q = $274.34/r¯ = $17.15 per TH/s for the average firm. Based on these estimates, we approximate the marginal hash cost of an average firm to be ¯? = ?e +?q = $43.07/TH. We assume firms have heterogeneous marginal hash costs ?i, and are arranged in increasing order with ?1 = (1 ? ?)¯? and ?N = (1 + ?)¯?. The marginal hash costs ?i of firms i = 2,...,N ? 1 are evenly distributed between these two extreme values. We set the parameter ? which determines the level of heterogeneity to 0.1. In Section 6.2, we analyze the sensitivity of our results to different ? values.We use the amount of R&D expenditures reported in the Financial Section of Bitmain’s IPO Prospectus (Bitmain (2018)) to estimate the parameter ? of the R&D cost function. During the period January 2015-June 2018, Bitmain allocated $181.8 millions to research and development, i.e., an average of K = $38.97 millions every 9 months. Moreover, in the period June 2016 through June 2019, Bitmain improved the hashing efficiency of the Antminer S series line by 20%, which amounts to an average 5% improvement every 9 months. Such an improvement corresponds to a decrease in the marginal hash cost of xi = 0.05¯?, where we recall that ¯? is the firms’ average marginal hash cost. We estimate the R&D cost function in our model by picking ? as the solution of the equation ?(xi)2/2 = K.Next, we discuss how to estimate mining rewards. Observe that, as of 2019, the Bitcoin protocol allows miners to obtain 12.5 newly minted bitcoins for successfully mining a block. Moreover, the mining difficulty is automatically adjusted so that, on average, one block is mined every 10 minutes. In addition to newly minted bitcoins, miners also profit from fees accrued for transactions processed in the block. The average transaction fees obtained from each mined block in the period between October 2018 and November 2019 is approximately 0.3 bitcoins per block. Therefore, we set thetotal reward obtained from the mining stage to	24hour ? 30day ? pD,where D is the duration of the mining game in months and p is the bitcoin price ($/BTC).To estimate the number of competing firms, we proceed as follows. We consider the historical daily price of bitcoin for the period September 2018-March 2019, during which the bitcoin price was stable. We then pick the value of N that minimizes the mean absolute error between the equilibrium hash rate predicted by Proposition 4.1 and the historical daily hash rate, yielding N = 5.Remark 6.1. In our model, firms instantly reacts to sudden price increase by increasing their hash rates. However, in practice, firms would respond with some delay, because they need to purchase computing equipment before being able to increase the exerted hash rate. Hence, using a period where bitcoin prices are highly volatile would significantly increase the estimation error and result in an inaccurate estimate of N. For example, Figure 2 highlights a sudden increase in bitcoin price during the period May-June 2019. If we had used the full period (i.e., September 2018 through November 2019) to estimate N, then our model would have underestimated N to reduce the estimation errorOct-201901-01-Oct-201801-Jan-201901-Apr-2019Jul-201901-24681012Total Hash Rate (TH/s)107Actual Hash Rate (TH/s)Predicted Hash Rate (TH/s)Oct-201901-01-Oct-201801-Jan-201901-Apr-2019Jul-201901-24681012Total Hash Rate (TH/s)107Actual Hash Rate (TH/s)Predicted Hash Rate (TH/s)Figure 2: Black solid line: historical aggregate hash rate. Red dashed line: model predicted aggregate hash rate. Time period: September 1, 2018, through November 20, 2019. during the period in which bitcoin price surged.Figure 2 shows that the hash rate predicted by our model closely matches the actual hash rate in the Bitcoin system during the period October 2018-April 2019. Our model overestimates the aggregate hash rate during the period May 2019-September 2019. This overshoot is due to a stylized feature of our model, where firms are assumed to react with zero delay to bitcoin prices (see also Remark 6.1). Nevertheless, the historically deployed hash rate converges quickly to the level predicted by our model towards the end of the period.	6.2	Matthew EffectIn this section, we show that firms’ investments in R&D exhibit a Matthew effect, which provides an explanation for the growing concerns about Bitcoin mining centralization. The Matthew effect is a social phenomenon linked to the idea of accumulated advantage, and often summarized by the maxim: “the rich get richer and the poor get poorer”. The impact of the Matthew effect is exacerbated by the fact that a per-unit hash cost slightly above the average is sufficient to drive a firm out of business (Corollary 4.2). We show that the degree of centralization increases with Bitcoin rewards and the level of hash costs heterogeneity ?.Figure 3 highlights that firms with an initial cost advantage tend to invest more in R&D, further increasing their advantage over others. The intuition behind this result is as follows. When all firms equally invest in R&D, those with lower marginal hash costs gain a larger fraction of1234500.511.522.51234500.511.522.5Figure 3: The figure plots firms’ individual R&D levels when p = $7,500. Firms are heterogeneous in hash costs with parameter ? = 0.1, and are arranged in the order of increasing initial marginal hash costs ?i. The figure shows that the firms’ R&D levels are inversely related to their initial marginal hash costs. Firms with an initial cost advantage will invest more in R&D.the aggregate hashing power. Since a higher fraction of the aggregate hashing power yields larger rewards, firms with lower marginal hash costs have a stronger incentive to invest in R&D. As a result, Bitcoin mining becomes more concentrated after the R&D investments phase. To measure this effect quantitatively, we use the Herfindahl index , where sj is the fraction of the aggregate hashing power exerted by firm j.As of November 21 2019, the price of bitcoin was $7,642. At this price, and assuming a hash cost heterogeneity parameter ? equal to 0.1, our calibrated model predicts that the Herfindahl index would increase from 0.2160 (prior to the R&D phase) to 0.2232 (after the R&D investments phase), i.e., a 3.33% increase in concentration. The relative changes in Herfindahl indices after R&D investments are highly sensitive to Bitcoin rewards (see Table 1). Ceteris paribus, the higher is the bitcoin price, the larger is the degree of centralization. If bitcoin were to maintain an average price of $20,000 (bitcoin actually exceeded this price on December 17, 2017), then the Herfindahl index would increase to 0.2579 after the 9 months R&D period, thus implying a 19.4% increase inconcentration.Table 1 reports the values of the Herfindahl index before and after R&D investments for three different values of ?. The numerical values confirm that the tendency towards centralization implied by the Matthew effect holds regardless of the value of ?. In addition, the values in the table indicate that, the higher the level of heterogeneity, and the stronger is the tendency towards centralization.?=0.05Bitcoinprice($/bitcoin)HerfindahlindexbeforeR&DinvestmentsHerfindahlindexafterR&DinvestmentsRelativechange100001.30%0.20400.206615000%0.20930.20402.61200005.08%0.21440.20402500010.84%0.22610.20403000032.34%0.27000.2040?=0.1Bitcoinprice($/bitcoin)HerfindahlindexbeforeR&DinvestmentsHerfindahlindexafterR&DinvestmentsRelativechange100004.910.2160%0.226015000%9.910.21600.2374200000.21600.257919.40%250000.21600.308242.69%3000087.22%0.21600.4044?=0.15Bitcoinprice($/bitcoin)HerfindahlindexbeforeR&DinvestmentsHerfindahlindexafterR&DinvestmentsRelativechange100000.26000.236010.16%150000.28450.236020.53%200000.31250.236032.40%250000.23600.375459.05%300000.23601.0000323.73%Table1:TheHerfindahlindex,beforeandafterR&D,andtherelativechangeinHerfindahlindex?=0.05Bitcoinprice($/bitcoin)HerfindahlindexbeforeR&DinvestmentsHerfindahlindexafterR&DinvestmentsRelativechange100001.30%0.20400.206615000%0.20930.20402.61200005.08%0.21440.20402500010.84%0.22610.20403000032.34%0.27000.2040?=0.1Bitcoinprice($/bitcoin)HerfindahlindexbeforeR&DinvestmentsHerfindahlindexafterR&DinvestmentsRelativechange100004.910.2160%0.226015000%9.910.21600.2374200000.21600.257919.40%250000.21600.308242.69%3000087.22%0.21600.4044?=0.15Bitcoinprice($/bitcoin)HerfindahlindexbeforeR&DinvestmentsHerfindahlindexafterR&DinvestmentsRelativechange100000.26000.236010.16%150000.28450.236020.53%200000.31250.236032.40%250000.23600.375459.05%300000.23601.0000323.73%Table1:TheHerfindahlindex,beforeandafterR&D,andtherelativechangeinHerfindahlindex(HHI after R&D investmentsHHI before R&D investments?HHI before R&D investments) for different bitcoin prices and ? values.For example, by increasing ? from 0.1 to 0.15, the relative change in concentration would rise from 19.4% to 32.4% at the $20,000 bitcoin price level.Our prediction of Bitcoin mining centralization is supported by the timeline of mining hardware developments (see Taylor (2017) for a comprehensive coverage). To keep up with the improvements in mining hardware efficiency, two Bitcoin mining hardware companies, San Francisco-based HashFast and Austin-based CoinTerra, developed a 28-nm ASIC miner in October 2013. However, these companies were caught of guard by the development of Bitmain’s and Bitfury’s chips in November 2013. These chips turned out to be more energy efficient, and forced HashFast and CoinTerra to file for bankruptcy in May 2014 and March 2015, respectively. The only firms which survived were those able to adapt to the rapid advancements in mining technology, and included Bitmain, Bitfury,Canaan, Halong Mining and Ebang.	7	ConclusionWe develop a model of Bitcoin mining competition in which firms first invest in R&D and subsequently compete in the mining game. Our model embeds two critical properties of the PoW protocol. First, rewards attained by firms are proportional to the fraction of hashing power they exert. Second, the total number of coins that can be mined in a given period is fixed, regardless of the total hashing power exerted. These properties reflect the intrinsic characteristic of the hash function in the PoW protocol and the adaptive difficulty level of the computational problem. We demonstrate that these two properties of the Bitcoin system lead to a R&D arms race between firms. If firms do not coordinate their decisions in the mining game, they fail to capture the surplus created by their R&D because more research expenditures lead to a higher competition in the mining game. We show that technological spillovers, in addition to reducing duplication in R&D and improving firms’ profits, may also lower the hash rate marginal costs, and thus increase the aggregate hash rate deployed in the system.Our analysis shows that the two properties of the PoW protocol mentioned above are also sufficient to drive the Bitcoin mining industry towards centralization, against the fundamental principles behind the design of blockchain and cryptocurrencies. We show that the per-unit hash cost threshold above which a firm would go out of business is slightly above the average per-unit hash cost. Moreover, firms with lower initial marginal hash costs have a higher incentive to invest in R&D. As a result, firms with an initial advantage in mining hardware will increase their advantage even further, driving firms with a higher initial cost out of the competition. Our calibrated model predicts that the degree of centralization increases with Bitcoin rewards and with the level of initial heterogeneity in hash costs. Our results thus imply that the current design of the Bitcoin mining protocol may not be able to support a long-lasting decentralized payment system.Few studies (e.g. Beikverdi and Song (2015), Cong et al. (2019)) have empirically tested mining centralization by analyzing the structure of mining pools. However, those studies do not consider the distribution of mining power among actual miners. For example, a mining company that owns a large percent of the total mining power exerted in the Bitcoin system may easily conceal hashing concentration by distributing its mining power among multiple pools. To the best of our knowledge, it remains an open empirical question to identify the power distribution among individual miners.One possible strategy to identify mining power concentration is to track the payments made by mining pools to participants.A potential remedy against mining centralization is to make Bitcoin’s PoW protocol sequentially memory-hard so that mining would require substantial amount of memory and bandwidth. Such high requirements would challenge even the parallel memory usage of supercomputers, reducing the effectiveness of specialized mining hardware, and in turn diminishing the risk of centralization. Nevertheless, the employment of less specialized mining equipment would imply that those aiming for a Goldfinger attack may use hardware which can be later re-purposed for different uses, significantly lowering the cost of such an attack. We leave the analysis of cost and benefits of alternative protocols for future research.ReferencesAbadi, J. and Brunnermeier, M. (2018). Blockchain economics. Working paper, Princeton Univer-sity.Acs, Z. J. and Audretsch, D. B. (1988). Innovation in large and small firms: An empirical analysis. The American Economic Review, 78(4):678–690.Arnosti, N. and Weinberg, S. M. (2019). Bitcoin: A natural oligopoly. In 10th Innovations in Theoretical Computer Science, pages 5:1–5:1. Schloss Dagstuhl - Leibniz-Zentrum fuer Informatik.Beikverdi, A. and Song, J. (2015). Trend of centralization in Bitcoin’s distributed network. In2015 IEEE/ACIS 16th International Conference on Software Engineering, Artificial Intelligence, Networking and Parallel/Distributed Computing (SNPD), pages 1–6.Biais, B., Bisiere, C., Bouvard, M., Casamatta, C., and Menkveld, A. J. (2018). Equilibrium Bitcoin pricing. Working paper. Available at SSRN: https://ssrn.com/abstract=3261063.Biais, B., Bisi`ere, C., Bouvard, M., and Casamatta, C. (2019). The Blockchain Folk Theorem. The Review of Financial Studies, 32(5):1662–1715.Bitmain (2018). Application proof of BitMain technologies holding company. Preprint available at: http://templatelab.com/bitmain-ipo-prospectus/ [Online; last accessed 15-December-2019].B¨ohme, R., Christin, N., Edelman, B., and Moore, T. (2015). Bitcoin: Economics, technology, and governance. Journal of Economic Perspectives, 29(2):213–38.Bonneau, J., Miller, A., Clark, J., Narayanan, A., Kroll, J. A., and Felten, E. W. (2015). SoK: Research perspectives and challenges for Bitcoin and cryptocurrencies. In 2015 IEEE Symposium on Security and Privacy, pages 104–121. IEEE.Cheng, E. (2018). Secretive Chinese Bitcoin mining company may have made as much money as Nvidia last year. CNBC. https://www.cnbc.com/2018/02/23/secretive-chinese-bitcoin-miningcompany-may-have-made-as-much-money-as-nvidia-last-year.html [Online; posted 23-Feb-2018, last accessed 15-December-2019].Chiu, J. and Koeppl, T. V. (2017). The economics of cryptocurrencies–Bitcoin and beyond. Working Paper 1389, Queen’s Economic Department. Available at SSRN:https://ssrn.com/abstract=3048124.Cong, L. W., He, Z., and Li, J. (2019). Decentralized mining in centralized pools. Working Paper 25592, National Bureau of Economic Research. Available at SSRN:https://ssrn.com/abstract=3143724.Conti, M., Sandeep Kumar, E., Lal, C., and Ruj, S. (2018). A survey on security and privacy issues of Bitcoin. IEEE Communications Surveys Tutorials, 20(4):3416–3452.Dasgupta, P. (1986). The theory of technological competition. In New developments in the Analysis of Market Structure, pages 519–549. Springer.d’Aspremont, C. and Jacquemin, A. (1988). Cooperative and noncooperative R&D in duopoly with spillovers. The American Economic Review, 78(5):1133–1137.Dimitri, N. (2017). Bitcoin mining as a contest. Ledger, 2:31–37.Easley, D., O’Hara, M., and Basu, S. (2019). From mining to markets: The evolution of Bitcoin transaction fees. Journal of Financial Economics, 134(1):91–109.Gencer, A. E., Basu, S., Eyal, I., van Renesse, R., and Sirer, E. G. (2018). Decentralization in Bitcoin and Ethereum networks. In Financial Cryptography and Data Security, pages 439–457. Springer Berlin Heidelberg.Goyal, S. and Moraga-Gonz´alez, J. L. (2001). R&D networks. The RAND Journal of Economics, 32(4):686–707.Halaburda, H. and Sarvary, M. (2016). Beyond Bitcoin. Palgrave Macmillan US.Hileman, G. and Rauchs, M. (2017). 2017 global blockchain benchmarking study. Technical report, Cambridge Centre for Alternative Finance, University of Cambridge, Cambridge, UK. Available at SSRN: https://ssrn.com/abstract=3040224.Hinzen, F. J., John, K., and Saleh, F. (2019). Proof-of-work’s limited adoption problem. Working paper, NYU Stern School of Business. Available at SSRN: https://ssrn.com/abstract=3334262.Huberman, G., Leshno, J., and Moallemi, C. (2019). An economic analysis of the Bitcoin payment system. Columbia Business School Research Paper No. 17-92. Available at SSRN:https://ssrn.com/abstract=3025604.Kamien, M. I., Muller, E., and Zang, I. (1992). Research joint ventures and R&D cartels. The American Economic Review, 82(5):1293–1306.Kharif, O. (2018).	Many Bitcoin miners are at risk of turning unprofitable.	Bloomberg.https://www.bloomberg.com/news/articles/2018-04-18/bitcoin-miners-facing-a-shakeout-asprofitability-becomes-harder [Online; posted 18-April-2018, last accessed 15-December-2019].Khatri, Y. (2019).	Bitfury partners to launch Bitcoin mining centers in Paraguay.	Coin-desk. https://www.coindesk.com/bitfury-partners-to-launch-bitcoin-mining-centers-in-paraguay [Online; posted 4-Feb-2019, last accessed 15-December-2019].Nakamoto,	S.	(2008).	Bitcoin:	A	peer-to-peer	electronic	cash	system.	Available:https://bitcoin.org/bitcoin.pdf [Online; last accessed 15-December-2019].Narayanan, A., Bonneau, J., Felten, E., Miller, A., and Goldfeder, S. (2016). Bitcoin and Cryptocurrency Technologies: A Comprehensive Introduction. Princeton University Press, Princeton,NJ, USA.Pagnotta, E. (2018). Bitcoin as decentralized money: Prices, mining rewards, and network security. Working paper, Imperial College Business School. Available at SSRN:https://ssrn.com/abstract=3264448.Pagnotta, E. and Buraschi, A. (2018). An equilibrium valuation of Bitcoin and decentralized network assets. Working paper, Imperial College Business School. Available at SSRN: https://ssrn.com/abstract=3142022.Rauchs, M., Blandin, A., Klein, K., Pieters, G. C., Recanatini, M., and Zhang, B. Z. (2018).2nd global cryptoasset benchmarking study. Technical report, Cambridge Centre for Alternative Finance. Available at SSRN: https://ssrn.com/abstract=3306125.Roper, S. (1997). Product innovation and small business growth: A comparison of the strategies of German, UK and Irish companies. Small Business Economics, 9(6):523–537.Saleh, F. (2018a). Blockchain without waste: Proof-of-stake. Working paper, McGill University.Available at SSRN: https://ssrn.com/abstract=3183935.Saleh, F. (2018b). Volatility and welfare in a crypto economy. Working paper, McGill University. Available at SSRN: https://ssrn.com/abstract=3235467.Suzumura, K. (1992). Cooperative and noncooperative R&D in an oligopoly with spillovers. The American Economic Review, 82(5):1307–1320.Taylor, M. B. (2017). The evolution of Bitcoin hardware. Computer, 50(9):58–66.	A	Revenue functionIf a hashing power hi is exerted, the time ?i required by miner i to solve the computational task is exponentially distributed with parameter  where D is the difficulty level. Therefore, the time until the first miner solves the computational task, ? = min(?1,...,?N), is exponentially distributed with parameter  and the probability that miner i is the first to solve the computational problem is . Furthermore, the parameter D is adjusted by the Bitcoin protocol to keep the expected time between solving two computational tasks fixed. This implies that bitcoin rewards in the second stage game do not depend on miners’ total computational power. After accounting for the bitcoin exchange rate, we denote by R the conversion of these bitcoins rewards into traditional fiat currency (e.g. $). Thus, if miner i exerts a hash rate hi, he is expected to update a fraction of the blocks in the second stage mining game, giving him an expected revenue.	B	Equilibrium Algorithms for Heterogeneous Firms	B.1	Equilibrium Hash ProfileThe following algorithm computes the unique equilibrium hash rate profile h(x) for any R&D profile x. The convergence of this algorithm is implied directly from the proof of Proposition 4.1 (see also Remark D.2).Algorithm 1. Initialize k = 1:	•	Set k = k + 1 and compute .	•	For i = 1,...,N, if i ≤ k set. Otherwise, set .	•	If k < N and return to step 1. Otherwise, set.	B.2	Equilibrium R&D ProfileWhen initial marginal hash cost parameters ?i are firm-specific, the equilibrium R&D profile can no longer be computed in closed-form. To solve for the equilibrium, we propose the following algorithm.Algorithm 2. Initialize k = 0 and x0 = (0,...,0):	•	Set k = k + 1 and xk := xk?1. For i = 1,...,N,	zi =	argmax	,	and update x.0≤y≤??? Pj6=i xkj	•	 return to step 1. Otherwise, set x := xk.This algorithm is an application of best-response dynamics and thus, by definition, it yields an equilibrium when the algorithm converges.	C	Robustness of Equilibrium Predictions to Firms HeterogeneityWe estimate the model primitives as discussed in Section 6.1. As it appears from Figures 4 and 5, the equilibrium predictions of Theorem 5.1 carry over to the setting where firms have heterogeneous marginal hash costs. Figure 4 indicates that the total hash rate and R&D levels are increasing in the bitcoin price, consistently with the first part of Theorem 5.1. In Figure 5, we analyze the dependence of the aggregate hash rate and R&D levels on R&D spillovers. Consistently with the first part of Proposition 5.3, the figure shows that the total R&D is decreasing in the spillover parameter ? when firms are heterogeneous in initial hash costs. It is also evident from the figure that the spillover parameter at which the aggregate hash rate is maximized when firms are heterogeneous is very close to, i.e., to the optimal value when firms are homogeneous.	D	Proofs	D.1	Proofs of Proposition 4.1To avoid excessive use of notation, we frequently suppress the dependence of ci(xi) on xi throughout the section. We first prove three preliminary lemmas.Lemma D.1. At any equilibrium hash rate profile,	•	There are at least two active firms.121.50.50Bitcoin Price (USD/BTC)1040510152025N = 3N = 5N = 821.510.50Bitcoin Price (in USD/BTC)10400.511.522.5H108N = 3N = 5N = 8121.50.50Bitcoin Price (USD/BTC)1040510152025N = 3N = 5N = 821.510.50Bitcoin Price (in USD/BTC)10400.511.522.5H108N = 3N = 5N = 8Figure 4: We set the spillover parameter to ? = 0, and assume firms are heterogeneous in hash costs with parameter ? = 0.1. The left panel plots the aggregate R&D level Pj xj as a function of the bitcoin price. An increase in the price of bitcoin induces firms to increase their investments in R&D, even when firms do not have the same initial hash cost. This suggests that the conclusions of Theorem 5.1 are robust to heterogeneity in firms’ initial hash cost. The right panel plots the aggregate hash rate H as a function of the bitcoin price.567823400.10.20.30.40.5 = 0 = 0.1567823400.10.20.30.40.5 = 0 = 0.1100.20.40.60.80246810N = 3N = 5N = 8100.20.40.60.80246810N = 3N = 5N = 8Figure 5: We set the bitcoin price to $7,500. The left panel plots the aggregate R&D Pj xj as a function of the spillover parameter ? when the heterogeneity parameter ? is 0.1. The aggregate R&D is decreasing in the spillover parameter ?, again supporting the robustness of the conclusions from Theorem 5.1 to hash costs heterogeneity. The right panel plots the spillover threshold ?¯ at which the total hash rate is maximized, both for a setting with homogeneous (? = 0) and heterogeneous (? = 0.1) firms. Regardless of whether firms are homogeneous or heterogeneous in initial hash costs, the threshold function has a similar dependence on the number N of firms. Specifically, if the number of firms is small, the hash rate is maximized for a low value of the spillover parameter. As the number of firms increase, the spillover parameter that maximizes the aggregate hash rate approaches, but never exceeds, the limiting value 0.5.	•	The set of active firms is of the form {1,2,...,n} for some integer n ? {2,3,...,N}.Proof. For the first part, suppose towards a contradiction there is an equilibrium h? in which only firm i is active. Firm i’s profit is given by.By definition of being active, since 0 firm i can improve its profits by decreasing its hash rate to  for  > 0 small enough. This leads to a contradiction. If none of firms are active, then any firm i can improve its profits by increasing its hash rate to , where  > 0 is smallenough so that.For the second part, suppose towards a contradiction there exists an equilibrium h? such that ci ≤ cj for j ? A and i 6? A. Because j ? A, we have hj? > 0. Moreover, by definitionof an equilibrium,	,	(6)otherwise firm j is better of setting	= 0. However, ci ≤ cj together with (6) imply,and hence firm i can improve its profits by exerting a positive hash rate hi, leading to a contradiction. Note that the case where only firm 1 is active is excluded by the first part of this lemma.Lemma D.2. For each n ≥ 2, we have the following n-firm candidate equilibrium hash rate profile	,	for 1 ≤ i ≤ n(7)	???0,	for n + 1 ≤ i ≤ N.Proof. Because at least two firms are active in equilibrium, the total hash rate H is strictly positive, and thus the profit function of each firm is continuous for any unilateral deviation. By the second part Lemma D.1, it is enough to consider equilibrium hash rate profiles of the form h	0) in which the first n ≥ 2 firms (i.e., those with the lowest per-unit hash costs) are active. Fix n and suppose that h(n) is an equilibrium hash rate profile. Then,h(n) must satisfy the system of first-order conditions		(8)where is the firms’ total hash rate in equilibrium. By summing the first-orderconditions over all firms and solving for H(n), we obtain	,	(9)where is the sum of the active firms’ hash costs. Using the identity  to solve for in (8), we obtain		(10)Finally, substituting (9) into (10), we obtain		(11)Remark D.1. The candidate equilibrium in Lemma D.2 can fail to be a Nash equilibrium of the mining game for two reasons: (I) h?i < 0 for some 1 ≤ i ≤ n, or (II) for some n + 1 ≤ i ≤ N. A necessary and sufficient condition for h?i < 0 is that ci > HR?, that is, and hence firm i is better off not exerting any hash rate. This meansthat it is too competitive for firm i to participate and hence the equilibrium hash rate profile would have a smaller number of active firms. If (II) holds, firm i’s marginal profit at h?i = 0 is positive and hence firm i is better off increasing its hash rate and participating. Hence, an equilibrium hash rate profile would consist of a larger number of active firms.Lemma D.3. Suppose there exists n < N for which n- and (n+1)-firm candidate equilibria have individual hash rate levels given by (7). Then, the following statements hold:	•	If n = 2, both firms exert a positive hash rate regardless of the hash costs c1 and c2.	•	Firm n+1 will want to participate in the n-firm equilibrium if and only if it exerts a positive hash rate in the (n + 1)-firm equilibrium.	•	If firm n does not have an incentive to participate in the n-firm equilibrium, then firm n + 1 does not have an incentive to participate in the (n + 1)-firm equilibrium. Proof. For the first part, substituting n = 2 in (7) giveswhich is always positive regardless of the values of c1 and c2.For the second part, observe that firm n + 1 wants to participate in the n-firm candidateequilibrium if and only if	0. By (7), we have		(12)which implies that firm n + 1 will exert a positive hash rate in the (n + 1)-firm equilibrium if and only if c(n+1) ? ncn+1 > 0. Then,0	by substituting (9)	?? c(n+1) ? ncn+1 > 0	add and subtract cn+1	0	by (12)For the third part, suppose that firm n does not exert a positive hash rate in the n-firm equilibrium. Then, by (12),c(n) ? (n ? 1)cn ≤ 0 ? c(n) ? (n ? 1)cn+1 ≤ 0since cn+1 ≥ cn? c(n+1) ? ncn+1 ≤ 0add and subtract cn+1	0	by (12)Remark D.2. Lemma D.3 suggests a constructive procedure for the equilibrium hash profile. We start with the two-firm candidate equilibrium and check whether firm 3, i.e., the firm with the third lowest cost, is willing to participate depending on its marginal profits at h(2). If firm 3 decides to participate, then these three firms would all exert a positive hash rate in three-firm equilibrium by the second statement of Lemma D.3. We repeat this process until a firm is not willing to participate. The proof of Proposition 4.1 shows that this process yields a unique equilibrium hash rate profile.Proof of Proposition 4.1. By the first statement of Lemma D.3, both firms are willing to participate in the two-firm candidate equilibrium and will exert a positive hash rate. We proceed by induction. Suppose that for n < N, there exists a candidate equilibrium in which the first n firms exert apositive hash rate. If	0, then firm n + 1 wish to participateand any firms i ≤ n + 1 will exert a positive hash rate hn+1 in the (n + 1)-firm equilibrium by the second statement of Lemma D.3. Therefore, we can eliminate this n-firm candidate equilibrium. We proceed to add firms until either (i) the next firm does not wish to enter, or (ii) there are no additional firms that can be added. Since the number of firms is finite, this process will terminate in a finite number of iterations. Uniqueness is obtained by observing that if the next firm does not wish to enter, then there cannot be an equilibrium with a larger number of firms by the last statement of Lemma D.3. Given the equilibrium number of active firms n, the equilibrium hash rate profile is obtained from Lemma D.2.		D.2	Proofs of Section 5We first show the existence and uniqueness of a symmetric SPE under the more general framework considered in Section 5.2, which accounts for R&D spillovers. That is,,where 0 ≤ ? ≤ 1 and xi + ? Pj6=i xj ≤ ? < ?. We denote byci(x;j6=ithe marginal hash cost when the R&D profile is given by x. We frequently suppress the dependence of ci(x;?) on x and ? to simplify notation.Lemma D.4. When firms have the same marginal hash cost, i.e., ci = c for all i = 1,2,...,N, all firms will be active and the hash profile h is given byProof of Lemma D.4. It is clear that all firms are active because cN ? (N ? 1)ci = ci = c > 0 and hence h(N) > 0 by (12). Moreover, evaluating (12) when c = ci for all i = 1,...,N yields theresult.	Lemma D.5. Assumption 10 implies	•	.	•	.	•	.Proof of Lemma D.5. For the first part, observe that		(13)		(14)where the first inequality holds by part 1 of Assumption 10, the second inequality holds by just ignoring the first and last terms in the square brackets, and the last inequality follows from the fact that ? ≥ ?/2. Therefore, by (14), it is sufficient to show thatwhich, after straightforward algebraic simplifications can be shown to be equivalent to the inequal-ity 1 . This which clearly holds for all N ≥ 2 and 0 ≤ ? < 1.We follow the same argument for the second part. Observe that		(15)where the first inequality holds by part 1 of Assumption 10, the second inequality holds by ignoring the second and third term in the square brackets, and the last inequality follows from the fact that ? ≥ ?/2. Therefore, by (15), it is sufficient to show that,which can be simplified to 1 .	This last inequality clearly holds for all N ≥ 2 and 0 ≤ ? < 1.For the third part, observe that		(16)by part 2 of Assumption 10. Therefore, by the inequalities (13) and (16), it is sufficient to show thatwhich can be simplified to 2. The latter inequality holds for all N ≥ 2 and 0 ≤ ? < 1.Lemma D.6. Under Assumption 10, there exists a unique symmetric SPE, i.e., xi = xNC and hi = hNC for all i = 1,...,N, given byProof of Lemma D.6. To simplify notation, we suppress the dependence of marginal costs on R&D levels x and denote it simply as ci. By Lemma D.4, all firms will be active in any symmetric SPE. Therefore, in any symmetric SPE, firm i’s profit is given by.Differentiating with respect to xi, we obtainMoreover, when firm i is active and in the feasible set (i.e., xi +? Pj6=i xj ≤ ?), the profit function is concave in xi because≤ 0.The first inequality above follows from the fact that firm i is active (i.e., ), the second inequality is obtained by ignoring the negative terms except for ?, the third inequality follows by feasibility (i.e., ci ≥ ???) and activity of firm i, and the last inequality follows by Assumption 10.1. Using symmetry, i.e., xi = x for all i = 1,...,N, the first order conditions ∂πi/∂x = 0 can besimplified to.This quadratic equation provides two potential symmetric equilibrium R&D levels given by	, and	(18)	.	(19)The solutions xS1 and xS2 are both real since(20)which holds by part 1 of Lemma D.5. First, we show that xi = xS1 for all i = 1,2,...,N is indeed a symmetric equilibrium. The actions xi = xS1 for all i = 1,2,...,N are feasible since		(21)by (20) and hencexi + ? Xxj = xS1(1 + (N ? 1)?) < ?/2 ≤ ?.j6=iNext, we show that firm i does not have a profitable deviation. Note that, when firm i modifies its R&D decision xi, it might become inactive. Particularly, when xj = xS1 for all j 6= i, firm i’s profit is given by,	if, 	if.Clearly, when, it is optimal for firm i to set xi = 0 and obtain zero profits. On the other hand, when, then xS1 is the unique maximizer satisfying the firstand second order conditions. Moreover, when xi = xS1 for all i = 1,...,N, the profit for firm i ispositive since ,where the first inequality follows from the fact that,and the last inequality by part 2 of Lemma D.5. Therefore, xi = xS1 is the best response for firm i and xi = xS1 for all i = 1,...,N is indeed a symmetric equilibrium.Next, we show that no other symmetric R&D profile can be an equilibrium. We will first show that xi = xS2 for all i = 1,...,N, which satisfies the first order conditions, is not feasible. That is, we will show that xi + ? Pj6=i xj > ?. Observe thatby symmetryby (19)square both sidessolve for ?,and the last inequality follows from part 3 of Lemma D.5.Finally, we check the corner points xe1 = 0 and . When xi = xe1 for all i =1,...,N, then firm i’s marginal profits can be simplified to,which is positive for all N ≥ 2 and 0 ≤ ? < 1. Hence, it would be profitable for firm i to increase its R&D. Analogously, when xi = xe2 for all i = 1,...,N, then firm i’s marginal profits can besimplified to,which is negative for all N ≥ 2 and 0 ≤ ? < 1 by part 3 of Lemma D.5. Hence, it would be profitable for firm i to decrease its R&D. Therefore, the unique symmetric equilibrium is xNC = xS1. Proof of Theorem 5.1. Setting ? = 0 in Lemma D.6, we obtain that there exists a unique symmetric SPE with.It is straightforward to see that xNC is increasing in R. This proves part (i). Part (ii) follows by observing that,where the strict inequality holds because 	Proof of Proposition 5.2. For the first part, observe that,where the inequality holds by Assumption 2. Moreover, in a symmetric equilibrium, i.e., c(xNC) = ci(xNC) for all i = 1,2,...,N, we have,because xNC > 0 by part (ii) of Theorem 5.1. For the second part, it is clear from the analysis in Section 5.1 that.To show the final inequality, i.e., xFC < xNC, note that		(22)because and . Therefore, it is sufficient to show.Rearranging the previous inequality and squaring both sides, we obtain ,where	0 holds by Assumption 1. Expanding the square term on the right hand side of the inequality and simplifying, we obtain the inequality .Such an inequality always holds because the left hand side is strictly negative and the right hand side is non-negative.Proof of Proposition 5.3. It follows directly from Lemma D.6 that there exists a unique symmetric SPE with R&D levels given by.For part (i), by differentiating xNC with respect to ?, we obtainSimplifying (23) yields	.	(24)After algebraic simplifications to the numerator, it can be seen that requiring (24) to be negative is equivalent to requiring that.This is a weaker condition than Assumption 10 and hence 0. Notice that if firms are symmetric and compete on R&D, the equilibrium profit function of firm Because we have shown above that xi = xNC is decreasing in ?, πi(x) must increase in ?. For part (ii), recall from Lemma D.4 that the total hash rate is given by.Therefore, whether or not HNC is increasing in ? depends solely on the second term in the denom-inatorf(?) := N(1 + (N ? 1)?)xNC.Differentiating it with respect to ? yields.Plugging the expression (23) into in the above equation and making simplifications, we obtain.Hence	= 0 when .	Finally, the result follows from the fact that ∂?∂f > 0when ? < ?¯ and ∂?∂f < 0 when ? > ?¯, and hence f(?) is strictly quasiconcave.